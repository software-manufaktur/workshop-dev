<!doctype html>
<html lang="de">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SeeYou Schmuck ‚Äì Workshops</title>
  <link rel="icon" href="static/logo.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: { colors: { brand: '#AF9778', graysoft: '#E6E6E6', graymid: '#CCCBCD' } } }
    }
  </script>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#AF9778">

  <!-- iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="SeeYou Workshops">
  <link rel="apple-touch-icon" href="static/icons/logo.png">

  <style>
    /* neues BG-Bild */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      z-index: -2;
      background: url("static/bg.jpg") center/cover no-repeat;
      filter: brightness(1.02);
    }

    body::after {
      content: "";
      position: fixed;
      inset: 0;
      z-index: -1;
      background: linear-gradient(to bottom, rgba(255, 255, 255, .85), rgba(255, 255, 255, .9));
    }

    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>
</head>

<body class="text-slate-900">
  <header class="max-w-4xl mx-auto px-4 py-4">
    <div class="grid grid-cols-3 items-center">
      <div>
        <button id="btnSettings" class="px-3 py-2 rounded-xl bg-graysoft hover:bg-graymid text-sm">‚öôÔ∏è Einstellungen</button>
      </div>

      <div class="justify-self-center flex items-center gap-3">
        <img src="static/logo.png" alt="SeeYou" class="h-10 w-auto relative z-10">
        <h1 class="text-xl font-semibold" style="color:#AF9778">SeeYou</h1>
      </div>

      <div class="flex items-center gap-2 justify-self-end">
        <button id="btnMenu" class="sm:hidden p-2 rounded-xl bg-graysoft hover:bg-graymid" aria-label="Men√º">‚ò∞</button>

        <div class="hidden sm:flex gap-2">
          <button id="btnManageSlots" class="px-3 py-2 rounded-xl bg-graysoft hover:bg-graymid text-sm">Neuer Termin</button>
          <button id="btnExportCsv" class="px-3 py-2 rounded-xl bg-graysoft hover:bg-graymid text-sm">CSV Export</button>
          <button id="btnBackup" class="px-3 py-2 rounded-xl bg-graysoft hover:bg-graymid text-sm">Backup</button>
          <label class="cursor-pointer px-3 py-2 rounded-xl bg-graysoft hover:bg-graymid text-sm">
            Wiederherstellen <input type="file" id="fileRestore" class="hidden">
          </label>
          <button id="btnArchiveView" class="px-3 py-2 rounded-xl bg-graysoft hover:bg-graymid text-sm">Archiv</button>
        </div>
      </div>
    </div>
  </header>

  <div id="mobileMenu" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/40" data-close="mobilemenu"></div>

    <div id="mobilePanel" class="absolute right-0 top-0 h-full w-[80%] max-w-xs bg-white shadow-2xl p-4 flex flex-col gap-3
              translate-x-full transition-transform duration-200">
      <div class="flex items-center justify-between mb-2">
        <span class="text-lg font-semibold" style="color:#AF9778">Men√º</span>
        <button class="text-slate-500 hover:text-slate-700" data-close="mobilemenu">‚úï</button>
      </div>

      <button id="m_btnSettings" class="px-3 py-3 rounded-xl bg-graysoft text-left">‚öôÔ∏è Einstellungen</button>
      <button id="m_btnManageSlots" class="px-3 py-3 rounded-xl bg-graysoft text-left">Neuer Termin</button>
      <button id="m_btnExportCsv" class="px-3 py-3 rounded-xl bg-graysoft text-left">CSV Export</button>
      <button id="m_btnBackup" class="px-3 py-3 rounded-xl bg-graysoft text-left">Backup</button>
      <label class="cursor-pointer px-3 py-3 rounded-xl bg-graysoft text-left">
        Wiederherstellen <input type="file" id="m_fileRestore" class="hidden">
      </label>
      <button id="m_btnArchiveView" class="px-3 py-3 rounded-xl bg-graysoft text-left">Archiv</button>
    </div>
  </div>

  <section class="max-w-4xl mx-auto px-4">
    <div class="grid grid-cols-1 sm:grid-cols-[1fr_auto] gap-3 my-3">
      <input id="search" class="w-full px-3 py-3 rounded-xl border border-graymid/60 bg-white/80 backdrop-blur" placeholder="Suche nach Name, Telefon, Titel, Datum‚Ä¶">
      <select id="filterStatus" class="px-3 py-3 rounded-xl border border-graymid/60 bg-white/80 min-w-[120px]">
        <option value="">alle</option>
        <option value="open">offen</option>
        <option value="full">voll</option>
        <option value="past">vergangen</option>
        <option value="archived">archiv</option>
      </select>
    </div>
  </section>

  <main class="max-w-4xl mx-auto px-4 pb-28" id="list"></main>

  <div id="modalBooking" class="modal fixed inset-0 z-50 bg-black/40 hidden items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-5">
      <div class="flex items-center justify-between mb-3">
        <h2 id="modalBookingTitle" class="text-lg font-semibold" style="color:#AF9778">Buchung</h2>
        <button data-close="booking" class="text-slate-500 hover:text-slate-700">‚úï</button>
      </div>
      <form id="formBooking" class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <label class="flex flex-col gap-1">
          <span class="text-sm">Anrede</span>
          <select id="bk_salutation" class="px-3 py-2 rounded-xl border border-graymid/60">
            <option value="Liebe/r">Liebe/r</option>
            <option value="Liebe">Liebe</option>
            <option value="Lieber">Lieber</option>
          </select>
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Name *</span>
          <input required type="text" id="bk_name" class="px-3 py-2 rounded-xl border border-graymid/60">
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Telefon *</span>
          <input required type="tel" id="bk_phone" class="px-3 py-2 rounded-xl border border-graymid/60">
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Personen *</span>
          <input required type="number" min="1" step="1" id="bk_count" class="px-3 py-2 rounded-xl border border-graymid/60" value="1">
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Kontaktkanal</span>
          <select id="bk_channel" class="px-3 py-2 rounded-xl border border-graymid/60">
            <option value="">‚Äì</option>
            <option>Instagram</option>
            <option>WhatsApp</option>
            <option>E-Mail</option>
            <option>Triviar</option>
            <option>Telefonisch</option>
            <option>Pers√∂nlich</option>
          </select>
        </label>
        <label class="md:col-span-2 flex flex-col gap-1">
          <span class="text-sm">Notiz</span>
          <textarea id="bk_notes" rows="3" class="px-3 py-2 rounded-xl border border-graymid/60"></textarea>
        </label>
        <div class="md:col-span-2 flex flex-col sm:flex-row gap-2">
          <button type="button" id="btnDeleteBooking" class="w-full sm:w-auto px-4 py-2 rounded-xl bg-rose-100 text-rose-700 hidden">L√∂schen</button>
          <button type="button" id="btnWhatsappShare" class="w-full sm:w-auto px-4 py-2 rounded-xl bg-emerald-600 text-white hidden">WhatsApp</button>
          <button type="button" data-close="booking" class="w-full sm:w-auto px-4 py-2 rounded-xl bg-graysoft">Abbrechen</button>
          <button type="submit" class="w-full sm:w-auto px-4 py-2 rounded-xl text-white" style="background:#AF9778">Speichern</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalSlots" class="modal fixed inset-0 z-50 bg-black/40 hidden items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-5">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-lg font-semibold" style="color:#AF9778">Termin anlegen / bearbeiten</h2>
        <button data-close="slots" class="text-slate-500 hover:text-slate-700">‚úï</button>
      </div>
      <form id="formSlot" class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <label class="flex flex-col gap-1 md:col-span-2">
          <span class="text-sm">Kategorie</span>
          <select id="sl_category" class="px-3 py-2 rounded-xl border border-graymid/60">
            <option>Schmuck-Workshop</option>
            <option>Kindergeburtstag</option>
            <option>JGA</option>
            <option>M√§delsabend</option>
            <option>Weihnachtsfeier</option>
            <option>Sonstiges</option>
          </select>
        </label>
        <label class="flex flex-col gap-1 md:col-span-2" id="row_title_other" style="display:none">
          <span class="text-sm">Titel (bei ‚ÄûSonstiges‚Äù)</span>
          <input type="text" id="sl_title_other" class="px-3 py-2 rounded-xl border border-graymid/60" placeholder="Eigener Titel">
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Kapazit√§t *</span>
          <input type="number" min="1" step="1" id="sl_capacity" class="px-3 py-2 rounded-xl border border-graymid/60" value="10" required>
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Start *</span>
          <input type="datetime-local" id="sl_starts" class="px-3 py-2 rounded-xl border border-graymid/60" required>
        </label>
        <label class="flex flex-col gap-1">
          <span class="text-sm">Ende *</span>
          <input type="datetime-local" id="sl_ends" class="px-3 py-2 rounded-xl border border-graymid/60" required>
        </label>
        <div class="md:col-span-2 flex flex-col sm:flex-row gap-2">
          <button type="button" data-close="slots" class="w-full sm:w-auto px-4 py-2 rounded-xl bg-graysoft">Abbrechen</button>
          <button type="submit" class="w-full sm:w-auto px-4 py-2 rounded-xl text-white" style="background:#AF9778">Speichern</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalConfirmDelete" class="modal fixed inset-0 z-50 bg-black/40 hidden items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-md p-6">
      <div class="flex items-start gap-3">
        <div class="text-2xl">‚ö†Ô∏è</div>
        <div>
          <h3 class="text-xl font-semibold mb-1 text-rose-700">Achtung</h3>
          <p class="text-slate-700">Termin wirklich l√∂schen? Alle zugeh√∂rigen Buchungen werden ebenfalls gel√∂scht.</p>
        </div>
      </div>
      <div class="mt-5 flex justify-end gap-2">
        <button id="btnCancelDelete" class="px-4 py-2 rounded-xl bg-graysoft">Abbrechen</button>
        <button id="btnConfirmDelete" class="px-4 py-2 rounded-xl bg-rose-600 text-white">Endg√ºltig l√∂schen</button>
      </div>
    </div>
  </div>

  <div id="modalSettings" class="modal fixed inset-0 z-50 bg-black/40 hidden items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-2xl p-5">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-lg font-semibold" style="color:#AF9778">Einstellungen</h2>
        <button data-close="settings" class="text-slate-500 hover:text-slate-700">‚úï</button>
      </div>
      <form id="formSettings">
        <label class="flex flex-col gap-1">
          <span class="text-sm font-medium">WhatsApp-Textvorlage</span>
          <p class="text-xs text-slate-500 mb-2">
            Du kannst folgende Platzhalter verwenden: [Anrede], [Name], [Datum], [Anzahl], [Du_Akk] (euch/dich), [Du_Dat] (euch/dir).
          </p>
          <textarea id="settings_whatsapp" rows="10" class="w-full px-3 py-2 rounded-xl border border-graymid/60 text-sm font-mono"></textarea>
        </label>
        <div class="mt-4 flex flex-col sm:flex-row gap-2">
          <button type="button" data-close="settings" class="w-full sm:w-auto px-4 py-2 rounded-xl bg-graysoft">Abbrechen</button>
          <button type="submit" class="w-full sm:w-auto px-4 py-2 rounded-xl text-white" style="background:#AF9778">Speichern</button>
        </div>
      </form>
    </div>
  </div>

  <div id="modalReminder" class="modal fixed inset-0 z-50 bg-black/40 hidden items-center justify-center p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-md p-6">
      <div class="flex items-start gap-3">
        <div class="text-2xl">üí°</div>
        <div>
          <h3 class="text-xl font-semibold mb-1" style="color:#AF9778">Erinnerung</h3>
          <p class="text-slate-700">Es ist wieder Zeit f√ºr ein Backup, um deine Daten zu sichern.</p>
        </div>
      </div>
      <div class="mt-5 flex justify-end gap-2">
        <button id="btnRemindLater" class="px-4 py-2 rounded-xl bg-graysoft">Sp√§ter</button>
        <button id="btnBackupNow" class="px-4 py-2 rounded-xl text-white" style="background:#AF9778">Jetzt sichern</button>
      </div>
    </div>
  </div>

  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur border border-gray-200 shadow-xl rounded-xl px-4 py-3 hidden max-w-[90%] text-center">
    <span id="toastMsg" class="text-sm"></span>
    <a id="toastLink" href="#" target="_blank" class="ml-3 underline" style="color:#AF9778">√ñffnen</a>
  </div>

  <script src="app.js?v=6"></script> <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js').catch(console.error);
    }
  </script>
</body>

</html>